<h1>JavaScript Intermediate</h1>
<h1>map, filter, reduce</h1>
<h3>Array-Methoden für die funktionale Programmierung</h3>
<h2>map</h2>
<ul>
<li>Ändert jeden Eintrag eines Arrays mit Hilfe einer Funktion ab</li>
<li>Rückgabewert: neues Array</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-keyword">let</span> myNumbers = [<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>];

<span class="hljs-keyword">let</span> triple = <span class="hljs-function"><span class="hljs-params">n</span> =></span> <span class="hljs-number">3</span> * n;

<span class="hljs-keyword">let</span> newNumbers = myNumbers.map(triple);
<span class="hljs-comment">// [6, 30, 69]</span>
</code></pre>
<h2>filter</h2>
<ul>
<li>Behält nur gewisse Einträge in einem Array</li>
<li>Nutzt eine Funktion, um Einträge auf ein bestimmtes Kriterium zu testen</li>
<li>Rückgabewert: neues Array</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-keyword">let</span> myNumbers = [<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>];

<span class="hljs-keyword">let</span> isEven = <span class="hljs-function"><span class="hljs-params">n</span> =></span> n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>;

<span class="hljs-keyword">let</span> newNumbers = myNumbers.filter(isEven);
<span class="hljs-comment">// [2, 10]</span>
</code></pre>
<h2>reduce</h2>
<ul>
<li>Verarbeitet die Einträge in einem Array zu einem einzelnen Wert</li>
<li>Verwendet eine Funktion, die aus zwei bestehenden Werten einen resultierenden Wert erstellt - diese Funktion wird wiederholt aufgerufen</li>
</ul>
<h2>reduce - Beispiel</h2>
<pre><code class="hljs language-js"><span class="hljs-keyword">let</span> transactions = [
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-56</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'groceries'</span> },
  { <span class="hljs-attr">amount</span>: +<span class="hljs-number">1020</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'salary'</span> },
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-13</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'dinner'</span> },
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-96</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'electricity'</span> },
];
<span class="hljs-keyword">let</span> initialBalance = <span class="hljs-number">317</span>;

<span class="hljs-keyword">let</span> reducer = <span class="hljs-function">(<span class="hljs-params">aggregator, transaction</span>) =></span>
  aggregator + transaction.amount;

<span class="hljs-keyword">let</span> currentBalance = transactions.reduce(
  reducer,
  initialBalance
);

<span class="hljs-comment">// 317 -> 261 -> 1281 -> 1268 -> 1172</span>
</code></pre>
<h1>Objektorientierte Programmierung (alt)</h1>
<h2>Prototypen und Konstruktorfunktionen</h2>
<p>OOP in JavaScript basiert nicht auf Klassen, sondern auf sogenannten <em>Prototypen</em></p>
<p>Vergleich aus dem echten Leben: Auto-Objekte</p>
<p>Eine Auto-Klasse wäre ein Bauplan für ein Auto</p>
<p>Ein Auto-Prototyp wäre ein bestehendes Auto auf dessen Vorlage weitere Autos gebaut werden können</p>
<h2>Prototypen und Konstruktorfunktionen</h2>
<p>Bei OOP in JavaScript beginnen wir damit, die Konstruktorfunktion zu schreiben, die ein Objekt initialisiert:</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Car</span>(<span class="hljs-params">brand, model</span>) </span>{
  <span class="hljs-keyword">this</span>.brand = brand;
  <span class="hljs-keyword">this</span>.model = model;
}
</code></pre>
<h2>Prototypen und Methodendefinition</h2>
<pre><code class="hljs language-js">Car.prototype.accelerate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'wrooom!'</span>);
};

Car.prototype.getDescription = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.make + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.model;
};
</code></pre>
<h2>Verwendung von Objekten</h2>
<pre><code class="hljs language-js"><span class="hljs-keyword">var</span> myCar = <span class="hljs-keyword">new</span> Car(<span class="hljs-string">'VW'</span>, <span class="hljs-string">'Golf'</span>);

<span class="hljs-built_in">console</span>.log(myCar);
<span class="hljs-built_in">console</span>.log(myCar.getDescription());
myCar.accelerate();
</code></pre>
<h1>Objektorientierte Programmierung (ab ES2015)</h1>
<h2>OOP (neu)</h2>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>{
  <span class="hljs-keyword">constructor</span>(brand, model) {
    <span class="hljs-keyword">this</span>.brand = brand;
    <span class="hljs-keyword">this</span>.model = model;
  }

  accelerate() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'wroom!'</span>);
  }
}
</code></pre>
<h2>OOP (neu)</h2>
<p>Vererbung</p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuxuryCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Car</span> </span>{
  openRoof() {}
}
</code></pre>
<h1>"this" und seine Quirks in JavaScript</h1>
<h2>"this" und seine Quirks</h2>
<p>In Objektmethoden bezieht sich <code>this</code> üblicherweise auf das aktuelle Objekt</p>
<p><strong>allerdings</strong>:</p>
<ul>
<li>jeder Funktionsaufruf setzt <em>this</em> neu (nicht nur Methodenaufrufe)</li>
<li><em>this</em> wird nur richtig gesetzt, wenn die Methode mit der Syntax <code>object.method()</code> aufgerufen wird</li>
</ul>
<h2>Problem: <em>this</em> in anonymen Funktionen</h2>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myComponent</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// this ist hier richtig gesetzt</span>
    <span class="hljs-keyword">this</span>.foo = <span class="hljs-literal">true</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">//this wird hier überschrieben (auf window)</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.foo);
    }, <span class="hljs-number">1000</span>);
  }
}
</code></pre>
<h2>Lösung: <em>Pfeilfunktionen</em></h2>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myComponent</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// this ist hier richtig gesetzt</span>
    <span class="hljs-keyword">this</span>.foo = <span class="hljs-literal">true</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =></span> {
      <span class="hljs-comment">// this wird hier *nicht* überschrieben</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.foo);
    }, <span class="hljs-number">1000</span>);
  }
}
</code></pre>
<h2>Problem: Methodenaufrufe ohne Methodensyntax</h2>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.message = <span class="hljs-string">'hello'</span>;
  }
  greet() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.message);
  }
}
<span class="hljs-keyword">const</span> foo = <span class="hljs-keyword">new</span> Foo();
foo.greet(); <span class="hljs-comment">// ok</span>
<span class="hljs-keyword">const</span> greet = foo.greet;
greet(); <span class="hljs-comment">// not ok ("this" is undefined)</span>
</code></pre>
<h2>Lösung: Pfeil-Methoden</h2>
<p>Seit ES2018 einsetzbar:</p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.message = <span class="hljs-string">'hello'</span>;
  }
  greet = <span class="hljs-function"><span class="hljs-params">()</span> =></span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.message);
  };
}
</code></pre>
<h2>Lösung: Binden von Methoden</h2>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> foo = <span class="hljs-keyword">new</span> Foo();
foo.greet(); <span class="hljs-comment">// ok</span>
<span class="hljs-keyword">const</span> greet = foo.greet.bind(foo);
greet(); <span class="hljs-comment">// ok</span>
</code></pre>
<p>Üblicherweise Zuweisung im Konstruktor:</p>
<pre><code class="hljs language-js">  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.greet = <span class="hljs-keyword">this</span>.greet.bind(<span class="hljs-keyword">this</span>);
  }
</code></pre>
<h1>Libraries</h1>
<h2>Libraries</h2>
<p>verbreitete Libraries:</p>
<ul>
<li><em>lodash</em> (Sammlung nützlicher Funktionen)</li>
<li><em>jQuery</em> (Erleichtert das Arbeiten mit dem DOM)</li>
<li><em>immer.js</em> / <em>immutable.js</em> (Arbeiten mit unveränderlichen Objekten)</li>
<li><em>moment.js</em> (Arbeiten mit Zeitangaben)</li>
</ul>
<h2>jQuery</h2>
<p>Ändern von Elementen</p>
<ul>
<li><code>$('#myelement')</code></li>
<li><code>el.html('content')</code></li>
<li><code>el.css('color', 'blue')</code></li>
<li><code>el.addClass('abc')</code></li>
<li><code>el.prop('style')</code></li>
</ul>
<h2>jQuery</h2>
<p>Erstellen / hinzufügen / entfernen von Elementen</p>
<ul>
<li><code>$('&#x3C;div>')</code></li>
<li><code>parent.append(child)</code></li>
<li><code>child.remove()</code></li>
</ul>
<h2>jQuery</h2>
<p>Abfragen von Events</p>
<ul>
<li><code>$(element).on('click', ...)</code></li>
<li><code>$(element).click(...)</code></li>
</ul>
<h2>immutable.js</h2>
<p>Bietet insbesondere die Datenstrukturen <em>List</em> und <em>Map</em> als unveränderliche Alternativen zu <em>Array</em> und <em>Object</em>.</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { List, <span class="hljs-built_in">Map</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'immutable'</span>;

<span class="hljs-keyword">const</span> a1 = List([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
<span class="hljs-keyword">const</span> a2 = a1.push(<span class="hljs-number">4</span>);

<span class="hljs-keyword">const</span> b1 = <span class="hljs-built_in">Map</span>({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> });
<span class="hljs-keyword">const</span> b2 = b1.set(<span class="hljs-string">'b'</span>, <span class="hljs-literal">null</span>);
</code></pre>
<h2>immutable.js</h2>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> { fromJS, setIn } <span class="hljs-keyword">from</span> <span class="hljs-string">'immutable'</span>;

<span class="hljs-keyword">const</span> todos = fromJS([
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'groceries'</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'gardening'</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
]);

<span class="hljs-keyword">const</span> newTodos = todos.setIn([<span class="hljs-number">1</span>, <span class="hljs-string">'completed'</span>], <span class="hljs-literal">true</span>);
</code></pre>